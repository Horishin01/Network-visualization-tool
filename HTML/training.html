<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ネットワーク学習ツール</title>

  <!-- 既存CSS -->
  <link rel="stylesheet" href="../CSS/style.css" />
  <link rel="stylesheet" href="../CSS/map.css" />

  <!-- Leaflet（地図用） -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- このページだけで完結させるための最小CSS（map.cssがなくても動く） -->
  <style>
    :root { --map-border:#c5ccd6; --map-bg:#f7f9fc; }
    .page-wrap  { max-width:1200px; margin:0 auto; padding:24px; }
    header,footer{ max-width:1200px; margin:0 auto; }
    nav ul { list-style:none; padding:0; display:flex; gap:16px; }
    nav a  { text-decoration:none; color:#1a1a1a; }

    /* 固定サイズの地図コンテナ（1200×520）。狭い画面は横スクロールで崩さない */
    .map-wrap      { display:flex; justify-content:center; margin-block:16px; overflow-x:auto; }
    .map-wrap.fixed #map {
      width:1200px;           /* ← 必要に応じて変更 */
      height:520px;           /* ← 必要に応じて変更 */
      border:1px solid var(--map-border);
      border-radius:12px;
      background:var(--map-bg);
    }
    /* Leaflet 背景色を角丸に合わせる（視覚的ノイズ低減） */
    .leaflet-container { background:var(--map-bg); }
  </style>
</head>
<body>

    <!-- ▼ 共通ヘッダー -->
    <header>
        <h1>ネットワーク学習ツール</h1>
        <nav>
            <ul>
                <li><a href="../index.html">ホーム</a></li>
                <li><a href="#">トレーニング</a></li>
                <li><a href="#">このサイトについて</a></li>
            </ul>
        </nav>
    </header>

    <!-- ▼ メインコンテンツ -->
    <main class="page-wrap">
        <section class="main-section">
            <h2>日本地図（インタラクティブ）</h2>

            <!-- 固定サイズ地図。スマホ等で小さい場合は横スクロールで表示 -->
            <div class="map-wrap fixed">
                <div id="map" role="img" aria-label="日本地図（インタラクティブ）"></div>
            </div>

            <!-- JavaScript無効時の静的フォールバック（任意） -->
            <noscript>
                <p>JavaScript が無効のため静的地図を表示します。</p>
                <img src="../assets/japan-map.png" alt="日本地図（静的画像）" width="900" />
            </noscript>
        </section>
    </main>

    <!-- ▼ 共通フッター -->
    <footer>
        <p>&copy; 2025 ネットワーク学習プロジェクト. All Rights Reserved.</p>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <script>
        // ===== 地図の初期化 =====
        const INITIAL_ZOOM = 5;
        const JAPAN_BOUNDS = L.latLngBounds([24.0, 122.0], [46.2, 146.0]);

        const map = L.map('map', {
            zoomControl: true,
            attributionControl: true,
            minZoom: INITIAL_ZOOM,
            maxZoom: 12,
            maxBounds: JAPAN_BOUNDS,
            maxBoundsViscosity: 1.0
        }).setView([36.5, 137.0], INITIAL_ZOOM);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; OpenStreetMap contributors'
        }).addTo(map);

        // ヘルパー
        const pin = (name, lat, lng) =>
            L.marker([lat, lng], { title: name })
                .addTo(map)
                .bindTooltip(name, { direction: 'top', offset: [0, -8] });

        // 通常の都市ピン
        pin('札幌', 43.0621, 141.3544);
        pin('大阪', 34.7025, 135.4959);

        // 東京 → home.html
        const tokyoMarker = pin('東京（クリックでホームへ）', 35.6812, 139.7671);
        tokyoMarker.on('click', () => { window.location.href = 'home.html'; });

        // 福岡 → company.html
        const fukuokaMarker = pin('福岡（クリックで会社へ）', 33.5902, 130.4017);
        fukuokaMarker.on('click', () => { window.location.href = 'fukuoka.html'; });

        // クリック可能であることをカーソルで示す
        function setPointerCursor(m) {
            m.on('add', () => { if (m._icon) m._icon.style.cursor = 'pointer'; });
        }
        setPointerCursor(tokyoMarker);
        setPointerCursor(fukuokaMarker);

        // 必要ならサイズ変更後に
        // map.invalidateSize();
    </script>
</body>
</html>
