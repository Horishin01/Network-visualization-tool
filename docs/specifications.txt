Network Visualization Tool - 仕様メモ
日付: 2025-12-04 (JST)
※生成AI運用規定: docs/ai_usage_guidelines.txt を必ず参照

概要
- 静的 HTML/CSS/JS で構成するネットワーク学習サイト。Python の簡易サーバーまたは Vite で配信。
- 共通ベース CSS: CSS/style.css。ページ固有レイアウトは各ページの CSS に分離。

ヒアリング反映（金澤先生）
- 対象と価値: 企業内ネットワーク構築・セキュリティ研修向けに焦点を絞る（高校教材では訴求が弱い）。「図を眺めるだけ」との差分を作るため、配線をいじって結果が変わるネットワーク実験／シミュレータとして打ち出す。
- 画面要件: 地図/PC クリックでその端末の設定・状態を表示できるディテールパネルを用意し、まず全体像→次に個別機器という流れで説明する。空の PC に必要ソフトをダウンロードしていく流れを見せ、物理専用機と思われないようにする。
- ネットワーク要件: 社内 NW は内側（社内）と外側（インターネット）を明確に分離し、FW を設置する意義を示す。社員 PC とサーバ群を論理的に分けて表示し、セグメント分離の妥当性を伝える。
- 技術方針: 今後のフロントエンドは TypeScript + コンポーネント指向フレームワーク（例: React/Vue/Svelte 等）で実装する。新規機能は生 HTML/CSS/JS 直書きではなく、TS で構成を定義し再利用可能なコンポーネント化を前提にする。
- TODO: 上記を踏まえて詳細仕様（対象ユーザー、ユースケース、画面遷移、表示する設定項目、技術スタック移行計画）を明文化する。

ページ構成
- index.html: ランディング。共通スタイルのみを使用。
- HTML/home.html + CSS/home.css + JS/home.js: 自宅 Wi-Fi 配線シミュレータ。ドラッグ配置、RJ45/光ケーブル描画、DHCP風IP割当、状態保存。
- HTML/company.html + CSS/company.css + JS/company.js + JS/company_store_bridge.js: 会社ネットワークシミュレータ。ONU/Router/Web/FTP/DNS 等を配線し、接続判定と状態保存を行う。
- HTML/training.html + CSS/map.css + JS/training.js + JS/training_boot.js: 日本地図とプレビュー画面。Home/Company/FTP バッジ表示、Leaflet でマーカー遷移、FTP 配置コンソール。
- HTML/sub.html + CSS/sub.css + JS/main.js: 連携ビュー＋仮想FTPアップロード＋仮想ブラウザ。

データ保存・ステート
- AppStore (JS/store.js) を共通キー app:network:saves:default で利用。storage: local または session。
- 会社側の FTP 配置: localStorage キー app:network:ftpUploads:v1 / app:network:ftpDeploy:v1。
- Company の edges 状態は company:lastEdges にもフォールバック保存。

レイアウト要点
- training (map.css): 2カラム（左=地図カード, 右=プレビュー列）。`.grid { grid-template-columns: 1fr 420px; }`、980px 以下で1カラム縦積み。地図は正方形 (`aspect-ratio: 1/1`)。
- 共通ヘッダーは style.css 側で青背景・白文字のフル幅バー。map.css では header/footer の横幅上書きに注意。

主要機能の流れ
- Home/Company 画面で配線 → AppStore へ保存 → Training/Sub でバッジに反映。
- Training の Leaflet マーカー: 東京=Home, 福岡=Company。クリックで各ページへ遷移。
- Training FTP: 会社側が T になるとコンソール解禁。アップロード済み/ローカルファイルを3拠点に割り当て、プレビュー iframe で確認。
- Sub の仮想FTP: ブラウザ上で HTML/TXT を localStorage に保存し、プレビュー・削除・ダウンロードが可能。

開発・タスク
- VS Code tasks: python -m http.server 8080 (背景タスク), npm run dev/build。launch でブラウザ自動オープン。
- server.py: ThreadingHTTPServer を 8000（または PORT 環境変数）で起動。

今後の注意
- ページ固有 CSS で共通要素（header/nav/footer）を上書きしないようにする。
- レイアウト変更時は各カラム幅とブレークポイントを明示し、overflow-x に頼らない設計にする。
